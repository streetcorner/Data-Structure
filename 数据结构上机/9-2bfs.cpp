/*----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
File name: 09graph.cpp
Abstract:
1.Create a graph by adjacency list and display it.
2.BFS
Version: 1.0
Last modify:2016.10.30
Copyright(c) 2016 Wang Yumeng
All rights reserved.
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
#include<stdio.h>
#include<stdlib.h>
#include<iostream>

//图的邻接表存储表示
#define MAX_VERTEX_NUM 20
#define  MAXSIZE 100  //  最大队列长度
using namespace std;

//邻接表表示
typedef char VertexData; //顶点数据类型
typedef int EdgeData;              //边上权值类型
//边结点
typedef struct node {
    int dest;                 //目标顶点下标
    EdgeData cost;//int        //边上的权值
    struct node * link;      //下一边链接指针
} EdgeNode;
//顶点结点
typedef struct {
    VertexData data;       //顶点数据域
    EdgeNode *firstAdj;   //边链表 头指针
} VertexNode;
typedef struct { //图的邻接表
    VertexNode VexList[MAX_VERTEX_NUM]; //邻接表
    int n, e;      //图中当前的顶点个数与边数
} AdjGraph;

//队列
typedef struct{
    int  *base;
	 //初始化时动态分配存储空间的基址
    int front;    //队头指针，指向队头元素
    int rear;     //队尾指针，指向队尾元素的下一个位置
}SqQueue;


//邻接表的构造算法(无向图)
void CreateGraph (AdjGraph &G) {
    int tail,head,weight;
    printf("Please input the number of vertex and edges:\n");
    scanf ("%d %d", &G.n, &G.e);
//输入顶点个数和边数
    //cout<<G.n<<endl;
    for ( int i = 0; i < G.n; i++) {
        printf("Please input the data of the %dth vertex:\n",i);
        scanf("%d",&G.VexList[i].data ); //输入顶点信息
        G.VexList[i].firstAdj = NULL;
    }
    for (int i = 0; i < G.e; i++) {         //逐条边输入
        printf("Please input the[tail head weight] of the %dth edge:\n(the tail and head is the index of the node)\n",i);
        scanf ("%d %d %d",&tail,&head,&weight );
        //链入第 tail 号链表的前端
        EdgeNode *p = new EdgeNode;
        p->dest = head;   p->cost = weight;
        p->link = G.VexList[tail].firstAdj;//头插
        G.VexList[tail].firstAdj = p;

        //链入第 head 号链表的前端
		p = new EdgeNode;//分配空间
        p->dest = tail;   p->cost = weight;
        p->link = G.VexList[head].firstAdj;//头插
        G.VexList[head].firstAdj = p;
    }
}

void display(AdjGraph &g){
    printf("The adjacent list is as follows:\n");
    for(int i = 0; i < g.n; i++){
        EdgeNode *p = new EdgeNode;
        p = g.VexList[i].firstAdj;//头结点
        //printf("vertex data:%d \n",p->dest);
        printf("vertex data:%d",g.VexList[i].data);
        while(p){
            printf(" dest:%d cost:%d", p->dest,p->cost);//dest is the index of the node
            p=p->link;
        }
        printf("\n");
    }
}
int InitQueue_Sq(SqQueue &Q) {//构造一个空队列Q
        Q.base=(int * )malloc
        (MAXSIZE*sizeof (int));
      if (!Q.base) exit (1);    //存储分配失败
      Q.front = Q.rear=0;
    return 1;
}  // InitQueue_Sq

int EnQueue_Sq(SqQueue  &Q, int  e ) {       //将元素e插入队尾
    if ((Q.rear+1)%MAXSIZE==Q.front) //队满
        return 0;
        Q.base[Q.rear] = e;      // 将元素e插入队尾
        Q.rear= (Q.rear+1)%MAXSIZE;
  // 修改队尾指针
        return 1;
} // EnQueue_Sq

int DeQueue_Sq(SqQueue  &Q) {       //删除队头元素，用e返回其值,并返回OK；否
       //则返回ERROR
    if (Q.rear== Q.front) return 0; //队空
    int e =Q.base[Q.front] ;
    Q.front= (Q.front+1)%MAXSIZE; // 修改队头指针
    return e;
}  // EnQueue_Sq
bool QueueEmpty(SqQueue  &Q){
    if(Q.rear== Q.front) return 1;
    else return 0;
}
char GetValue(AdjGraph G, int v){
    return G.VexList[v].data;
}
int GetFirstNeighbor(AdjGraph g, int v){
    if(g.VexList[v].firstAdj)
        return g.VexList[v].firstAdj->dest;
    else return -1;
}
int GetNextNeighbor(AdjGraph g, int v, int w){
    EdgeNode *p = new EdgeNode;
    p = g.VexList[v].firstAdj;
    while(p){
        if(p->dest == w && p->link){//next node exists
            return p->link->dest;//index of the node
        }
        p=p->link;
    }
    return -1;
}
//图的广度优先搜索算法
void BFS (AdjGraph G, int visited[ ]) {
    //printf("%d " , GetValue (G,v) );
    visited[0] = 1;
    SqQueue q;
    InitQueue_Sq(q);
    EnQueue_Sq (q, 0);   //进队列
    while ( ! QueueEmpty (q) ) {  //队空搜索结束
        int v=DeQueue_Sq (q);
        printf("%d " , GetValue(G,v));
        int w = GetFirstNeighbor (G, v);
        while ( w != -1 ) { //若邻接顶点 w 存在,都加入队列
           if ( !visited[w] ) { //未访问过
                //printf("%d " , GetValue(G,w) );
                visited[w] = 1;
                EnQueue_Sq (q, w);
            }
           w = GetNextNeighbor (G, v, w);
        }        //重复检测 v 的所有邻接顶点
    }    //外层循环，判队列空否
    delete [ ] visited;
}

void Graph_Traverse (AdjGraph G) {
    printf("\nThe result of the DFS traverse is as follow:\n");
    int *visited = new int [G.n];
    for ( int i = 0; i < G.n; i++ )
        visited [i] = 0;   //访问数组 visited 初始化
        BFS (G, visited );
        //从顶点 i 出发开始搜索
    delete [ ]visited;   //释放 visited
}

int main(){
    AdjGraph g;
    CreateGraph(g);
    //cout<<g.n<<" "<<g.e<<endl;
    display(g);
    Graph_Traverse(g);
}



